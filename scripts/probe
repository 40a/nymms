#!/usr/bin/env python

import logutil
import os
from boto.sqs import connect_to_region

logger = logutil.setup_root_logger(stdout=logutil.INFO,
        filename='/tmp/nymms-probe-%d.log' % (os.getpid()),
        file_level=logutil.DEBUG)
logutil.quiet_boto_logging()

os.environ.setdefault('NYMMS_CONFIG', '~/git/nymms/conf/config.yaml')
from nymms.config import config

from nymms.resources import (MonitoringGroup, Monitor, Command, Node,
        load_resources)
from nymms.probe.sqsprobe import SQSProbe

resource_version = load_resources(config.settings['resources'])
conn = connect_to_region(config.settings['queue_region'])
p = SQSProbe(conn, config.settings['tasks']['name'])
p.run()
